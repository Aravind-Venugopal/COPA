function Telligent_CallbackManager(a,g,d){this._variableName=a;this._postbackName=g;this._form=document.getElementById(d)}
Telligent_CallbackManager.prototype._responseCallback=function(a,g,d,c){if(a.readyState==4){a=a.responseText;if(a.length>0&&a.substr(0,1)=="s"){a=eval("("+a.substr(1)+")");c=new Telligent_ScriptLoader;if(a.includeScriptUrls&&a.includeScriptUrls.length>0)for(var b=0;b<a.includeScriptUrls.length;b++)c.AddScriptToLoad(new Telligent_ScriptToLoad(true,a.includeScriptUrls[b]));if(a.startupScripts&&a.startupScripts.length>0)for(b=0;b<a.startupScripts.length;b++)c.AddScriptToLoad(new Telligent_ScriptToLoad(false,
a.startupScripts[b]));c.LoadAll();if(g)try{g(a.response,d)}catch(e){alert(e.message)}try{__theFormPostData="";__theFormPostCollection=[];WebForm_InitCallback()}catch(j){}}else if(a.substr(0,1)=="e")c?c(a.substr(1),d):alert(a.substr(1));else c&&c(null,d)}};
Telligent_CallbackManager.prototype._doCallback=function(a,g,d,c){var b=this._getXmlHttpRequest();if(b!=null){var e;if(this._form!=null&&this._form.action)e=this._form.action;else{e=window.location.href;e=e.replace(/\#.*$/,"")}b.open("POST",e,true);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");var j=eval(this._variableName);b.onreadystatechange=function(){j._responseCallback(b,g,d,c)};e=this._postbackName+"=";if(a!=null)e+=encodeURIComponent(a);if(this._form!=
null)for(a=0;a<this._form.length;a++){var f=this._form.elements[a];if(f.name){var h=null;if(f.nodeName=="INPUT"){var i=f.type.toLowerCase();if(i=="text"||i=="password"||i=="hidden")h=f.value;else if((i=="checkbox"||i=="radio")&&f.checked)h=f.value}else if(f.nodeName=="SELECT"||f.nodeName=="TEXTAREA")h=f.value;if(h&&f.name!=this._postbackName)e+="&"+f.name+"="+encodeURIComponent(h)}}b.send(e);delete b}};
Telligent_CallbackManager.prototype._getXmlHttpRequest=function(){var a=null;if(typeof XMLHttpRequest!="undefined")a=new XMLHttpRequest;else try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){}}return a};
function Telligent_ScriptLoader(){this._scriptsToLoad=[];this._currentScript=0;this.AddScriptToLoad=function(a){this._scriptsToLoad[this._scriptsToLoad.length]=a};this.LoadAll=function(){this._scriptsToLoad.length>0&&this._currentScript<this._scriptsToLoad.length&&this._scriptsToLoad[this._currentScript].Load(Telligent_Common.CreateSafeFunction(this,this._loadSuccessful),Telligent_Common.CreateSafeFunction(this,this._loadFailed))};this._loadSuccessful=function(){this._currentScript++;this.LoadAll()};
this._loadFailed=function(a){if(a)alert(a.message);else window.error?alert(window.error.message):alert("An unknown error occured while loading scripts associated to the latest callback")}}
function Telligent_ScriptToLoad(a,g){this._isInclude=a;this._content=g;this._errorTimeout=this._errorCallback=this._completeCallback=this._element=null;this.Load=function(d,c){if(this._isInclude)if(this._isScriptIncludeRegistered(this._content))d&&d();else{this._element=document.createElement("script");this._element.src=this._content;this._completeCallback=d;this._errorCallback=c;if(Telligent_Common.IsSafari()){try{document.getElementsByTagName("HEAD")[0].appendChild(this._element)}catch(b){c&&c(b);
return}setTimeout(Telligent_Common.CreateSafeFunction(this,this._completeCallback),999)}else{if(Telligent_Common.IsIE())this._element.onreadystatechange=Telligent_Common.CreateSafeFunction(this,this._readyStateChanged);else{this._element.readyState="loaded";this._element.onload=Telligent_Common.CreateSafeFunction(this,this._readyStateChanged)}document.getElementsByTagName("HEAD")[0].appendChild(this._element);this._errorTimeout=setTimeout(Telligent_Common.CreateSafeFunction(this,this._errorOccured),
29999)}}else{var e=document.createElement("script");e.type="text/javascript";e.text=this._content;try{document.getElementsByTagName("HEAD")[0].appendChild(e);Telligent_Common.IsSafari()||document.getElementsByTagName("HEAD")[0].removeChild(e)}catch(j){c&&c(j);return}d&&d()}};this._isScriptIncludeRegistered=function(d){for(var c=document.getElementsByTagName("SCRIPT"),b=0;b<c.length;b++)if(c[b].src==d||c[b].src.indexOf(d)+d.length==c[b].src.length)return true;return false};this._readyStateChanged=
function(){if(this._element&&(this._element.readyState=="loaded"||this._element.readyState=="complete")){clearTimeout(this._errorTimeout);this._element.onreadystatechange=null;this._element.onload=null;this._element.onerror=null;this._completeCallback&&this._completeCallback()}};this._errorOccured=function(){if(this._element){this._element.onreadystatechange=null;this._element.onload=null;this._element.onerror=null}this._errorCallback&&this._errorCallback({message:"A script was not able to be loaded within the allowed time.  The callback has failed"})}}
;
